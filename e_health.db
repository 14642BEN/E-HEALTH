-- Create the database
CREATE DATABASE IF NOT EXISTS e_healthcare;
USE e_healthcare;

-- Patients table
CREATE TABLE IF NOT EXISTS patients (
    id INT AUTO_INCREMENT PRIMARY KEY,
    username VARCHAR(50) NOT NULL UNIQUE,
    password VARCHAR(100) NOT NULL,
    name VARCHAR(100),
    age INT
);

-- Doctors table
CREATE TABLE IF NOT EXISTS doctors (
    id INT AUTO_INCREMENT PRIMARY KEY,
    username VARCHAR(50) NOT NULL UNIQUE,
    password VARCHAR(100) NOT NULL,
    name VARCHAR(100),
    specialty VARCHAR(100)
);

-- Appointments table
CREATE TABLE IF NOT EXISTS appointments (
    id INT AUTO_INCREMENT PRIMARY KEY,
    patient VARCHAR(50),
    doctor VARCHAR(50),
    date DATE,
    FOREIGN KEY (patient) REFERENCES patients(username) ON DELETE SET NULL,
    FOREIGN KEY (doctor) REFERENCES doctors(username) ON DELETE SET NULL
);

-- File uploads table
CREATE TABLE IF NOT EXISTS uploads (
    id INT AUTO_INCREMENT PRIMARY KEY,
    username VARCHAR(50),
    filepath VARCHAR(255),
    uploaded_at TIMESTAMP DEFAULT CURRENT_TIMESTAMP,
    FOREIGN KEY (username) REFERENCES patients(username) ON DELETE CASCADE
);
